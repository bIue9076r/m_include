// random.c
#ifndef RANDOM_C
#define RANDOM_C
#include "random.h"

const int randtable[16] = {
	8,10,3,14,5,16,12,1,
	11,2,9,7,13,4,15,6
};

const int rt1[256] = {
	154, 162, 210, 124, 31, 139, 179, 83, 252, 176, 166, 213, 105, 177, 178, 113, 5, 251, 99, 18, 142, 182, 42, 209, 171, 67, 249, 135, 44, 49, 8, 153, 218, 129, 62, 48, 34, 16, 145, 239, 227, 51, 163, 126, 167, 234, 175, 103, 91, 2, 253, 229, 109, 93, 208, 24, 74, 173, 23, 101, 89, 28, 246, 80, 224, 186, 10, 84, 132, 168, 150, 73, 128, 183, 152, 131, 133, 156, 143, 250, 20, 81, 118, 137, 21, 115, 92, 140, 71, 54, 189, 107, 65, 123, 237, 164, 57, 95, 238, 6, 196, 181, 46, 248, 151, 216, 190, 39, 193, 82, 138, 202, 85, 30, 53, 172, 219, 254, 70, 114, 3, 157, 217, 233, 165, 98, 220, 240, 228, 27, 13, 121, 148, 242, 214, 155, 60, 222, 58, 235, 59, 102, 64, 56, 4, 127, 120, 12, 87, 33, 66, 22, 45, 68, 119, 36, 7, 192, 72, 97, 122, 161, 256, 104, 236, 221, 110, 247, 75, 32, 184, 199, 76, 223, 9, 206, 160, 207, 188, 194, 226, 185, 17, 19, 26, 37, 100, 241, 55, 38, 187, 231, 198, 94, 205, 136, 211, 169, 244, 86, 112, 1, 78, 116, 147, 41, 191, 200, 255, 130, 225, 111, 43, 204, 149, 230, 106, 134, 11, 158, 117, 79, 174, 159, 245, 96, 14, 201, 197, 90, 69, 212, 195, 47, 40, 203, 88, 63, 15, 144, 108, 35, 61, 77, 50, 232, 25, 243, 29, 146, 125, 52, 141, 170, 215, 180
};

const int rt2[256] = {
	154, 245, 165, 132, 24, 131, 9, 60, 97, 253, 15, 221, 212, 164, 174, 74, 73, 251, 197, 215, 64, 175, 139, 211, 75, 209, 3, 163, 8, 232, 5, 13, 49, 57, 65, 43, 199, 114, 152, 190, 184, 218, 208, 77, 220, 217, 246, 240, 227, 90, 147, 249, 231, 104, 101, 41, 55, 94, 102, 170, 178, 37, 159, 162, 29, 204, 181, 167, 226, 130, 107, 155, 124, 143, 213, 191, 229, 20, 219, 247, 161, 100, 118, 171, 150, 45, 21, 127, 230, 76, 30, 201, 256, 110, 69, 82, 62, 182, 135, 27, 207, 35, 255, 196, 242, 121, 244, 56, 91, 136, 2, 180, 106, 42, 151, 239, 225, 254, 26, 84, 16, 238, 28, 158, 129, 189, 63, 206, 109, 39, 117, 58, 31, 92, 105, 248, 134, 40, 157, 53, 50, 51, 78, 198, 120, 172, 93, 34, 10, 85, 160, 145, 48, 25, 103, 83, 125, 79, 234, 72, 126, 200, 98, 185, 144, 88, 19, 95, 32, 222, 210, 252, 87, 203, 12, 17, 138, 236, 128, 81, 52, 115, 183, 192, 216, 99, 176, 153, 68, 96, 44, 241, 11, 112, 187, 179, 156, 186, 23, 169, 250, 108, 80, 202, 46, 86, 113, 54, 47, 173, 18, 243, 111, 148, 1, 22, 214, 137, 122, 193, 149, 6, 133, 4, 33, 61, 195, 168, 123, 67, 38, 116, 194, 237, 166, 70, 59, 71, 228, 233, 140, 141, 89, 146, 7, 188, 66, 205, 142, 224, 36, 177, 119, 235, 223, 14
};

const int rt3[256] = {
	98, 254, 13, 117, 172, 153, 199, 35, 139, 167, 219, 59, 100, 213, 230, 158, 57, 248, 1, 190, 247, 170, 84, 114, 233, 25, 122, 249, 187, 121, 102, 29, 250, 164, 207, 163, 221, 128, 152, 46, 235, 73, 229, 53, 220, 223, 63, 90, 192, 242, 2, 166, 140, 91, 218, 168, 197, 28, 116, 18, 132, 246, 52, 173, 40, 134, 51, 72, 195, 93, 127, 198, 64, 185, 96, 115, 256, 241, 212, 32, 107, 58, 234, 125, 226, 104, 16, 43, 202, 6, 203, 61, 214, 9, 222, 70, 36, 236, 99, 227, 143, 147, 3, 55, 194, 31, 165, 137, 79, 204, 111, 33, 20, 81, 144, 103, 47, 92, 113, 184, 142, 123, 201, 50, 118, 71, 44, 15, 255, 145, 108, 105, 106, 54, 22, 110, 176, 205, 89, 7, 208, 232, 162, 174, 182, 200, 189, 38, 120, 78, 196, 211, 237, 77, 30, 26, 239, 85, 146, 224, 181, 180, 156, 171, 66, 67, 17, 252, 231, 27, 161, 119, 133, 88, 5, 157, 206, 193, 12, 68, 69, 124, 24, 8, 87, 188, 39, 225, 251, 169, 42, 41, 191, 112, 160, 151, 62, 83, 80, 48, 4, 95, 21, 135, 253, 159, 56, 11, 109, 101, 155, 23, 49, 34, 126, 75, 82, 183, 209, 177, 240, 148, 178, 179, 245, 37, 186, 217, 10, 136, 210, 130, 94, 141, 138, 19, 14, 45, 74, 243, 131, 216, 76, 129, 215, 154, 149, 175, 86, 228, 65, 60, 97, 244, 238, 150
};

const int rt4[256] = {
	216, 234, 208, 253, 252, 31, 189, 107, 17, 224, 201, 190, 37, 157, 206, 19, 212, 143, 238, 127, 50, 217, 193, 54, 3, 38, 205, 120, 184, 56, 142, 211, 235, 35, 192, 229, 67, 196, 112, 225, 29, 13, 87, 98, 133, 76, 90, 121, 15, 32, 138, 255, 63, 9, 117, 72, 77, 247, 122, 173, 123, 95, 81, 75, 152, 131, 36, 226, 221, 168, 175, 102, 183, 150, 249, 111, 130, 24, 21, 149, 41, 248, 241, 80, 57, 148, 86, 100, 182, 233, 2, 1, 61, 58, 105, 47, 113, 10, 194, 60, 114, 110, 66, 135, 240, 125, 139, 109, 115, 165, 46, 108, 187, 22, 8, 53, 188, 88, 153, 254, 242, 27, 71, 161, 159, 163, 136, 28, 200, 40, 185, 236, 134, 4, 251, 34, 26, 256, 164, 180, 232, 62, 243, 82, 177, 179, 85, 45, 228, 209, 202, 170, 237, 218, 101, 124, 215, 93, 207, 132, 79, 25, 245, 69, 48, 145, 78, 91, 43, 197, 51, 7, 64, 186, 118, 144, 55, 155, 20, 33, 167, 154, 160, 52, 89, 65, 18, 223, 227, 126, 39, 12, 14, 146, 156, 119, 244, 70, 214, 137, 250, 195, 246, 99, 174, 68, 172, 213, 204, 103, 116, 83, 104, 84, 181, 42, 219, 176, 230, 169, 11, 128, 222, 96, 97, 140, 203, 199, 73, 23, 59, 198, 191, 171, 106, 49, 162, 151, 147, 129, 141, 94, 166, 74, 158, 30, 239, 5, 178, 44, 92, 6, 231, 220, 210, 16
};

const int rt5[256] = {
	247, 55, 184, 250, 195, 90, 235, 23, 47, 135, 50, 119, 239, 228, 158, 26, 141, 113, 42, 3, 233, 246, 86, 243, 151, 136, 48, 97, 87, 150, 98, 67, 208, 111, 249, 88, 27, 84, 211, 200, 183, 217, 29, 207, 193, 216, 68, 25, 154, 21, 6, 140, 152, 41, 251, 99, 104, 142, 31, 39, 229, 51, 153, 191, 223, 43, 7, 194, 83, 166, 4, 177, 188, 189, 199, 72, 181, 248, 33, 225, 209, 155, 130, 123, 182, 172, 159, 58, 167, 69, 5, 165, 245, 252, 185, 232, 173, 169, 102, 52, 118, 203, 221, 218, 108, 219, 242, 213, 14, 96, 116, 18, 205, 254, 190, 174, 2, 128, 231, 35, 131, 147, 101, 126, 149, 49, 34, 234, 125, 253, 238, 120, 45, 187, 215, 1, 71, 65, 44, 122, 30, 201, 107, 85, 132, 256, 160, 139, 220, 13, 54, 8, 61, 138, 114, 32, 224, 36, 137, 127, 163, 117, 196, 62, 170, 94, 24, 175, 236, 186, 91, 226, 143, 206, 59, 105, 66, 77, 179, 100, 192, 9, 157, 162, 28, 89, 212, 144, 16, 129, 121, 81, 244, 78, 109, 202, 74, 176, 56, 227, 161, 70, 12, 19, 46, 178, 198, 115, 255, 124, 93, 20, 241, 82, 237, 10, 112, 80, 156, 53, 40, 110, 79, 106, 11, 92, 134, 180, 75, 103, 15, 95, 17, 214, 57, 222, 133, 64, 145, 60, 37, 73, 38, 204, 171, 164, 63, 230, 210, 168, 240, 146, 197, 76, 148, 22
};

const int rt6[256] = {
	240, 110, 46, 175, 167, 65, 100, 31, 78, 154, 28, 155, 166, 45, 26, 29, 133, 25, 93, 91, 252, 2, 207, 121, 57, 193, 126, 27, 56, 99, 77, 210, 229, 178, 24, 212, 191, 209, 43, 221, 161, 109, 61, 177, 147, 141, 239, 72, 111, 85, 48, 86, 137, 190, 32, 201, 164, 140, 71, 89, 19, 243, 227, 217, 10, 83, 11, 249, 218, 135, 75, 1, 42, 152, 244, 122, 205, 186, 3, 143, 189, 34, 197, 41, 40, 142, 228, 248, 55, 15, 38, 95, 50, 214, 94, 162, 123, 216, 198, 60, 98, 59, 13, 237, 69, 125, 245, 21, 183, 146, 256, 250, 231, 182, 170, 230, 81, 4, 12, 184, 134, 185, 196, 238, 247, 124, 66, 181, 22, 9, 30, 97, 180, 114, 5, 14, 163, 74, 102, 36, 120, 255, 127, 232, 107, 173, 172, 226, 17, 254, 235, 128, 151, 213, 204, 236, 174, 148, 253, 187, 52, 246, 206, 88, 7, 160, 158, 219, 49, 150, 157, 84, 138, 58, 20, 220, 234, 119, 6, 195, 211, 165, 233, 225, 116, 87, 241, 159, 108, 153, 67, 51, 82, 202, 192, 145, 92, 115, 18, 171, 132, 96, 35, 242, 106, 79, 112, 149, 168, 80, 129, 103, 33, 62, 54, 47, 117, 90, 215, 101, 104, 53, 23, 130, 8, 188, 118, 76, 64, 179, 105, 70, 37, 203, 208, 156, 136, 199, 223, 113, 169, 194, 39, 251, 68, 222, 73, 16, 63, 44, 144, 224, 200, 176, 139, 131
};

const int rt7[256] = {
	132, 199, 67, 6, 78, 164, 149, 247, 180, 95, 98, 32, 128, 76, 35, 153, 167, 188, 64, 174, 160, 8, 82, 37, 53, 99, 156, 105, 181, 62, 235, 192, 46, 38, 217, 47, 54, 9, 187, 125, 65, 10, 61, 59, 219, 28, 184, 202, 52, 150, 177, 91, 183, 189, 214, 107, 254, 135, 161, 113, 195, 115, 203, 116, 101, 123, 87, 121, 2, 242, 27, 144, 227, 186, 41, 4, 172, 93, 171, 117, 255, 83, 124, 243, 15, 158, 198, 60, 159, 39, 221, 223, 86, 55, 230, 206, 71, 251, 36, 25, 179, 112, 3, 207, 18, 241, 252, 166, 178, 131, 211, 109, 146, 43, 81, 246, 231, 66, 141, 72, 145, 229, 44, 12, 127, 185, 57, 216, 33, 204, 244, 11, 140, 29, 96, 24, 21, 111, 228, 108, 194, 147, 74, 197, 201, 103, 79, 63, 225, 130, 7, 182, 94, 139, 102, 122, 84, 90, 5, 104, 148, 118, 68, 97, 176, 226, 215, 152, 248, 70, 14, 151, 23, 233, 165, 191, 236, 48, 129, 196, 173, 42, 88, 237, 200, 45, 100, 245, 77, 110, 22, 232, 20, 56, 73, 143, 157, 256, 234, 193, 16, 34, 190, 249, 209, 142, 89, 222, 19, 133, 80, 163, 119, 85, 69, 30, 58, 120, 17, 31, 162, 238, 1, 205, 224, 26, 49, 170, 136, 51, 138, 253, 50, 154, 155, 137, 212, 250, 13, 126, 213, 134, 40, 220, 169, 92, 240, 208, 75, 218, 175, 239, 106, 210, 168, 114
};

const int rt8[256] = {
	166, 251, 170, 76, 8, 26, 189, 156, 104, 246, 190, 69, 154, 178, 44, 138, 77, 206, 116, 152, 235, 158, 169, 102, 153, 233, 255, 214, 209, 87, 70, 179, 28, 212, 175, 119, 205, 42, 98, 59, 230, 50, 231, 191, 110, 202, 17, 210, 30, 239, 45, 97, 64, 89, 9, 216, 256, 61, 40, 75, 132, 234, 39, 80, 225, 14, 105, 217, 244, 1, 106, 115, 121, 200, 86, 167, 95, 65, 182, 74, 52, 165, 238, 207, 37, 60, 131, 133, 226, 7, 15, 35, 111, 199, 136, 185, 130, 149, 3, 177, 88, 155, 85, 78, 126, 213, 150, 96, 38, 128, 160, 193, 236, 41, 48, 203, 127, 186, 56, 188, 157, 228, 122, 90, 118, 183, 227, 218, 36, 108, 242, 215, 34, 107, 252, 2, 49, 223, 62, 172, 224, 11, 120, 72, 123, 144, 55, 211, 180, 71, 6, 82, 248, 187, 247, 173, 250, 168, 117, 137, 23, 124, 196, 194, 31, 29, 24, 198, 19, 192, 81, 109, 33, 21, 163, 67, 220, 184, 83, 12, 232, 20, 176, 54, 249, 245, 79, 151, 129, 91, 222, 46, 145, 195, 101, 174, 25, 219, 241, 125, 16, 237, 141, 229, 93, 58, 134, 162, 68, 4, 243, 208, 99, 114, 22, 147, 161, 57, 84, 94, 113, 143, 142, 43, 253, 100, 10, 47, 240, 197, 73, 135, 13, 159, 18, 63, 51, 32, 171, 139, 181, 103, 27, 92, 112, 148, 164, 201, 146, 254, 204, 221, 140, 5, 66, 53
};

const int rt9[256] = {
	93, 107, 155, 33, 102, 202, 198, 143, 73, 116, 8, 27, 50, 25, 38, 24, 180, 244, 163, 221, 75, 85, 131, 253, 110, 105, 195, 140, 122, 43, 13, 45, 74, 52, 144, 94, 233, 54, 130, 28, 101, 92, 247, 55, 113, 41, 29, 139, 58, 26, 194, 34, 40, 104, 17, 68, 177, 169, 123, 57, 174, 196, 99, 90, 173, 218, 88, 63, 72, 183, 141, 109, 20, 235, 82, 115, 103, 49, 14, 217, 42, 66, 124, 147, 47, 231, 51, 119, 181, 167, 164, 136, 236, 188, 96, 18, 60, 37, 230, 16, 106, 138, 100, 175, 165, 148, 190, 219, 227, 209, 111, 203, 161, 95, 135, 53, 70, 204, 21, 150, 162, 208, 249, 220, 238, 2, 4, 121, 242, 207, 157, 108, 112, 241, 189, 62, 118, 91, 248, 252, 120, 117, 170, 206, 87, 197, 240, 237, 44, 31, 152, 245, 67, 215, 86, 39, 212, 80, 182, 186, 187, 5, 6, 159, 243, 229, 246, 254, 137, 128, 48, 84, 133, 255, 79, 154, 216, 171, 7, 77, 98, 224, 256, 59, 228, 89, 193, 239, 32, 251, 172, 205, 211, 223, 146, 156, 153, 19, 81, 158, 225, 3, 35, 125, 61, 226, 178, 23, 234, 11, 65, 214, 69, 222, 1, 127, 250, 232, 22, 9, 201, 168, 12, 200, 213, 179, 83, 78, 56, 129, 191, 126, 36, 46, 132, 10, 64, 160, 142, 176, 199, 134, 76, 192, 166, 71, 151, 15, 114, 30, 97, 149, 145, 210, 184, 185
};

const int rt10[256] = {
	195, 20, 35, 17, 135, 78, 154, 113, 215, 69, 173, 92, 216, 22, 146, 148, 51, 181, 59, 245, 109, 218, 253, 142, 254, 179, 55, 175, 110, 117, 185, 187, 86, 94, 77, 145, 178, 80, 123, 19, 105, 151, 172, 124, 61, 6, 111, 73, 79, 39, 202, 50, 4, 10, 101, 24, 180, 37, 2, 198, 207, 208, 126, 25, 205, 242, 144, 16, 190, 227, 247, 120, 14, 201, 212, 193, 85, 1, 58, 213, 167, 230, 174, 182, 40, 217, 97, 199, 161, 239, 116, 88, 159, 67, 65, 62, 231, 244, 255, 108, 162, 171, 219, 8, 252, 140, 44, 18, 204, 147, 36, 98, 95, 234, 82, 32, 49, 170, 256, 160, 54, 164, 249, 211, 184, 47, 224, 23, 241, 125, 75, 228, 70, 28, 52, 33, 158, 152, 221, 15, 166, 214, 238, 63, 100, 96, 81, 243, 210, 89, 133, 102, 103, 38, 141, 200, 87, 236, 183, 189, 149, 27, 196, 106, 137, 127, 157, 46, 143, 188, 64, 156, 150, 26, 177, 93, 130, 138, 53, 9, 12, 115, 222, 45, 248, 134, 13, 165, 251, 191, 220, 91, 197, 48, 99, 118, 153, 168, 83, 169, 163, 194, 176, 21, 226, 246, 11, 74, 60, 131, 155, 121, 57, 132, 237, 5, 206, 229, 41, 66, 225, 223, 250, 34, 104, 84, 139, 90, 56, 43, 235, 192, 209, 76, 119, 240, 233, 128, 31, 107, 42, 186, 71, 72, 203, 112, 68, 136, 7, 232, 29, 3, 129, 114, 30, 122
};

int *rt = (int*)&rt1;

int __r_offset = 0;
int __r__offset = 0;

void _rand_seed(int seed){
	__r__offset = randtable[seed % 16] % 16;
}

int _rand_i(void){
	int r = randtable[__r__offset];
	__r__offset++;
	if (__r__offset > 15){ __r__offset = 0; }
	return r;
}

void swaptbl(){
	int n = rt[__r_offset] % 9;
	switch (n){
		case 0: rt = (int*) &rt1; break;
		case 1: rt = (int*) &rt2; break;
		case 2: rt = (int*) &rt3; break;
		case 3: rt = (int*) &rt4; break;
		case 4: rt = (int*) &rt5; break;
		case 5: rt = (int*) &rt6; break;
		case 6: rt = (int*) &rt7; break;
		case 7: rt = (int*) &rt8; break;
		case 8: rt = (int*) &rt9; break;
		default: rt = (int*) &rt10; break;
	}
}

void rand_seed(int seed){
	__r_offset = rt[seed % 256] % 256;
	swaptbl();
}

int rand_i(void){
	int r = rt[__r_offset];
	__r_offset++;
	if (__r_offset > 256){ __r_offset = 0; }
	return r;
}

#endif